<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Quill</title>
  <link rel="stylesheet" href="style.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Source+Serif+4:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
</head>
<body>
  <div id="ws-app" class="ws-screen">
    <!-- Single-line menu bar: File Edit View Help | New Open Save Find | zoom -->
    <header class="ws-menubar" role="menubar">
      <div class="ws-menubar-inner">
        <div class="ws-menu-item" data-menu="file" aria-haspopup="true" aria-expanded="false">File</div>
        <div class="ws-menu-item" data-menu="edit" aria-haspopup="true" aria-expanded="false">Edit</div>
        <div class="ws-menu-item" data-menu="view" aria-haspopup="true" aria-expanded="false">View</div>
        <div class="ws-menu-item" data-menu="help" aria-haspopup="true" aria-expanded="false">Help</div>
      </div>
      <!-- Dropdown panels (hidden by default) -->
      <div id="ws-dropdown-file" class="ws-dropdown" role="menu" aria-label="File menu" hidden>
        <button type="button" role="menuitem" data-action="new"><span class="ws-menuitem-label">New</span><span class="ws-menuitem-shortcut">^N</span></button>
        <button type="button" role="menuitem" data-action="open"><span class="ws-menuitem-label">Open…</span><span class="ws-menuitem-shortcut">^O</span></button>
        <button type="button" role="menuitem" data-action="save"><span class="ws-menuitem-label">Save</span><span class="ws-menuitem-shortcut">^S</span></button>
        <button type="button" role="menuitem" data-action="saveAs"><span class="ws-menuitem-label">Save As…</span><span class="ws-menuitem-shortcut">M-S</span></button>
        <hr>
        <button type="button" role="menuitem" data-action="exit"><span class="ws-menuitem-label">Exit</span><span class="ws-menuitem-shortcut">M-Q</span></button>
      </div>
      <div id="ws-dropdown-edit" class="ws-dropdown" role="menu" aria-label="Edit menu" hidden>
        <button type="button" role="menuitem" data-action="blockBegin"><span class="ws-menuitem-label">Mark block begin</span><span class="ws-menuitem-shortcut">M-B</span></button>
        <button type="button" role="menuitem" data-action="blockEnd"><span class="ws-menuitem-label">Mark block end</span><span class="ws-menuitem-shortcut">M-E</span></button>
        <button type="button" role="menuitem" data-action="blockHide"><span class="ws-menuitem-label">Clear selection</span><span class="ws-menuitem-shortcut">Esc</span></button>
        <hr>
        <button type="button" role="menuitem" data-action="cut"><span class="ws-menuitem-label">Cut</span><span class="ws-menuitem-shortcut">^X</span></button>
        <button type="button" role="menuitem" data-action="copy"><span class="ws-menuitem-label">Copy</span><span class="ws-menuitem-shortcut">^C</span></button>
        <button type="button" role="menuitem" data-action="paste"><span class="ws-menuitem-label">Paste</span><span class="ws-menuitem-shortcut">^V</span></button>
        <hr>
        <button type="button" role="menuitem" data-action="find"><span class="ws-menuitem-label">Find…</span><span class="ws-menuitem-shortcut">^F</span></button>
        <button type="button" role="menuitem" data-action="findAgain"><span class="ws-menuitem-label">Find again</span><span class="ws-menuitem-shortcut">^L</span></button>
        <hr>
        <button type="button" role="menuitem" data-action="reformat"><span class="ws-menuitem-label">Reformat paragraph</span><span class="ws-menuitem-shortcut">^J</span></button>
      </div>
      <div id="ws-dropdown-view" class="ws-dropdown" role="menu" aria-label="View menu" hidden>
        <button type="button" role="menuitem" data-action="togglePreview"><span class="ws-menuitem-label">Preview</span><span class="ws-menuitem-shortcut">^P</span></button>
        <hr>
        <button type="button" role="menuitem" data-action="zoomIn"><span class="ws-menuitem-label">Zoom in</span><span class="ws-menuitem-shortcut">^+</span></button>
        <button type="button" role="menuitem" data-action="zoomOut"><span class="ws-menuitem-label">Zoom out</span><span class="ws-menuitem-shortcut">^-</span></button>
        <button type="button" role="menuitem" data-action="zoomReset"><span class="ws-menuitem-label">Reset zoom</span><span class="ws-menuitem-shortcut">^0</span></button>
        <hr>
        <button type="button" role="menuitem" data-action="toggleInsert"><span class="ws-menuitem-label">Toggle Insert / Replace</span><span class="ws-menuitem-shortcut">Ins</span></button>
        <hr>
        <button type="button" role="menuitem" data-action="font"><span class="ws-menuitem-label">Font…</span></button>
      </div>
      <div id="ws-dropdown-help" class="ws-dropdown" role="menu" aria-label="Help menu" hidden>
        <button type="button" role="menuitem" data-action="help"><span class="ws-menuitem-label">Keyboard shortcuts</span><span class="ws-menuitem-shortcut">^G</span></button>
      </div>
    </header>
    <!-- Status line: filename, page, line, col, insert, word count -->
    <div id="ws-status" class="ws-status">
      <span id="ws-filename">Untitled</span>
      <span id="ws-page">Page 1</span>
      <span id="ws-line">L=1</span>
      <span id="ws-col">C=1</span>
      <span id="ws-insert">Insert</span>
      <span id="ws-wordcount" class="ws-status-wordcount">0 words</span>
      <span id="ws-zoom-value" class="ws-status-zoom">100%</span>
    </div>
    <!-- Ruler line -->
    <div id="ws-ruler" class="ws-ruler">
      <span id="ws-ruler-content">L----!----!----!----!----!----!----!----R</span>
    </div>
    <!-- Main content: editor or Markdown preview -->
    <div id="ws-content-area" class="ws-content-area">
      <div id="ws-editor-wrap" class="ws-editor-wrap">
        <pre id="ws-text" class="ws-text" tabindex="0" spellcheck="false"></pre>
        <div id="ws-cursor" class="ws-cursor"></div>
      </div>
      <div id="ws-preview-wrap" class="ws-preview-wrap" aria-hidden="true">
        <div id="ws-preview" class="ws-preview"></div>
      </div>
    </div>
    <!-- Font chooser -->
    <div id="ws-font-dialog" class="ws-dialog-overlay" role="dialog" aria-label="Choose font" aria-hidden="true">
      <div class="ws-dialog-box">
        <div class="ws-dialog-title">Font</div>
        <p class="ws-dialog-message">Choose the font for the editor and UI.</p>
        <div class="ws-dialog-font-row">
          <select id="ws-font-select" class="ws-font-select" aria-label="Font family">
            <option value="IBM Plex Mono, Liberation Mono, Courier New, monospace">IBM Plex Mono</option>
            <option value="Liberation Mono, Courier New, monospace">Liberation Mono</option>
            <option value="Courier New, monospace">Courier New</option>
            <option value="Source Serif 4, Georgia, serif">Source Serif 4</option>
            <option value="Georgia, Times New Roman, serif">Georgia</option>
            <option value="system-ui, -apple-system, sans-serif">System UI</option>
          </select>
        </div>
        <div class="ws-dialog-buttons">
          <button type="button" class="ws-dialog-btn ws-dialog-btn-primary" data-font-apply>Apply</button>
          <button type="button" class="ws-dialog-btn" data-font-cancel>Cancel</button>
        </div>
      </div>
    </div>
    <!-- New document: unsaved changes? -->
    <div id="ws-new-dialog" class="ws-dialog-overlay" role="dialog" aria-label="Create new document" aria-hidden="true">
      <div class="ws-dialog-box">
        <div class="ws-dialog-title">Create new document?</div>
        <p class="ws-dialog-message">Current document has unsaved changes. Save before starting a new one, or discard changes?</p>
        <div class="ws-dialog-buttons">
          <button type="button" class="ws-dialog-btn ws-dialog-btn-primary" data-choice="save">Save</button>
          <button type="button" class="ws-dialog-btn" data-choice="discard">Don't save</button>
          <button type="button" class="ws-dialog-btn" data-choice="cancel">Cancel</button>
        </div>
      </div>
    </div>
    <!-- Help modal -->
    <div id="ws-help-overlay" class="ws-help-overlay" role="dialog" aria-label="Keyboard shortcuts" aria-hidden="true">
      <div class="ws-help-box">
        <div class="ws-help-header">Quill — Commands (^G or F1; Esc to close)</div>
        <div class="ws-help-body">
          <p class="ws-help-notation">^X = Ctrl+X &nbsp; M-X = Alt+X</p>
          <section><strong>Select &amp; copy</strong><br>Drag with the mouse to select text, or use M-B / M-E to mark block begin/end. Then ^C Copy &nbsp; ^X Cut &nbsp; ^V Paste. Esc clears selection.</section>
          <section><strong>File</strong><br>^N New &nbsp; ^O Open &nbsp; ^S Save &nbsp; M-S Save As &nbsp; M-Q Exit</section>
          <section><strong>Edit</strong><br>M-B Mark block begin &nbsp; M-E Mark block end &nbsp; Esc Clear selection<br>^X Cut &nbsp; ^C Copy &nbsp; ^V Paste<br>^F Find &nbsp; ^L Find again &nbsp; ^J Reformat paragraph</section>
          <section><strong>View</strong><br>^P Preview (render Markdown) &nbsp; ^+ ^- ^0 Zoom &nbsp; Ins Insert/Replace &nbsp; Font… (choose font)</section>
          <section><strong>Help</strong><br>^G or F1 This dialog &nbsp; Esc Close</section>
          <section><strong>Movement &amp; editing</strong><br>^E ^X ^S ^D Up Down Left Right &nbsp; ^A Word left &nbsp; Home/End Line start/end &nbsp; ^Home ^End Doc start/end<br>^Y Delete line &nbsp; ^T Delete word &nbsp; ^G Delete char &nbsp; Backspace &nbsp; Enter New line &nbsp; Tab Indent</section>
          <section><strong>Features</strong><br>Documents are <strong>Markdown</strong> (.md). Use # ## ### for headings, **bold**, *italic*, `code`, - lists. View → Preview (^P) shows rendered output. View → Font… changes the editor and UI font (saved). Menu bar: hover to open; all actions have keyboard shortcuts.</section>
          <section><strong>Credits</strong><br>“Quill” icon by EX Liberus, from Noun Project (CC BY 3.0).</section>
        </div>
      </div>
    </div>
    <!-- Hidden file input for open (fallback) -->
    <input type="file" id="ws-file-open" accept=".md,.txt,text/markdown,text/plain" style="display:none">
    <input type="file" id="ws-file-save" accept=".txt,.ws" style="display:none" webkitdirectory directory multiple>
  </div>
  <script src="app.js"></script>
</body>
</html>
